function doPost(e) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Users");
  const data = sheet.getDataRange().getValues();

  const input = JSON.parse(e.postData.contents);
  const nik = input.nik;
  const password = input.password;

  let success = false;
  let message = "NIK atau Password salah";

  for (let i = 1; i < data.length; i++) {
    if (data[i][0] == nik && data[i][1] == password) {
      success = true;
      message = "Login berhasil";
      break;
    }
  }

  const result = JSON.stringify({ success, message });

  return ContentService.createTextOutput(result)
    .setMimeType(ContentService.MimeType.JSON)
    .setHeader("Access-Control-Allow-Origin", "*")
    .setHeader("Access-Control-Allow-Methods", "POST")
    .setHeader("Access-Control-Allow-Headers", "Content-Type");
}

function doOptions(e) {
  return ContentService.createTextOutput("")
    .setMimeType(ContentService.MimeType.TEXT)
    .setHeader("Access-Control-Allow-Origin", "*")
    .setHeader("Access-Control-Allow-Methods", "POST")
    .setHeader("Access-Control-Allow-Headers", "Content-Type");
}
